{#include base}
    {#title}Ironsworn â€” Campaigns{/title}
    {#header-title}Campaigns{/header-title}

    {#stylesheets}
    <link rel="stylesheet" href="/play.css">
    {/stylesheets}

    {#content}
    <div class="campaigns-page">
        <h2>Your Campaigns</h2>

        {#if campaigns.isEmpty()}
        <p class="empty-state">No campaigns yet. Create one to begin your journey in the Ironlands.</p>
        {#else}
        <div class="campaign-list">
            {#for campaign in campaigns}
            <a href="/play/{campaign.id}" class="campaign-card">
                <h3>{campaign.name}</h3>
                <span class="campaign-id">{campaign.id}</span>
            </a>
            {/for}
        </div>
        {/if}

        <div class="new-campaign">
            <h3>New Campaign</h3>
            <form id="new-campaign-form">
                <label for="char-name">Character Name</label>
                <input type="text" id="char-name" placeholder="e.g., Kira of the Havens" required>
                <button type="submit" class="btn-primary">Begin</button>
            </form>
        </div>
    </div>
    {/content}

    {#footer-scripts}
    <script>
        document.getElementById('new-campaign-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const name = document.getElementById('char-name').value.trim();
            if (!name) return;

            const btn = e.target.querySelector('button');
            btn.disabled = true;
            btn.textContent = 'Creating...';

            try {
                const resp = await fetch('/api/play/campaigns', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name })
                });
                if (resp.ok) {
                    const campaign = await resp.json();
                    window.location.href = '/play/' + campaign.id;
                } else {
                    alert('Failed to create campaign: ' + resp.statusText);
                    btn.disabled = false;
                    btn.textContent = 'Begin';
                }
            } catch (err) {
                alert('Error: ' + err.message);
                btn.disabled = false;
                btn.textContent = 'Begin';
            }
        });
    </script>
    {/footer-scripts}
{/include}
